//----------------------------------*-C++-*-----------------------------------//
/**
 *  @file  TabuchiYamamoto.cc
 *  @brief TabuchiYamamoto member definitions
 *  @note  Copyright (C) Jeremy Roberts 2013
 */
//----------------------------------------------------------------------------//

#include "TabuchiYamamoto.hh"
#include "utilities/SoftEquivalence.hh"

namespace detran_angle
{

//----------------------------------------------------------------------------//
void TabuchiYamamoto::build_impl(c_dbl a, c_dbl b)
{
  Insist(d_m % 2 == 0, "T-Y is only available for even numbers of points.");
  Insist(detran_utilities::soft_equiv(a, -1.0) &&
         detran_utilities::soft_equiv(b,  1.0),
         "T_Y is defined only for polar angles, i.e. [-1, 1].");
  Insist(d_m / 2 < 6, "T-Y defined only for up to 5 points.");


  // polar cosines (the paper lists sines).  4 & 5 point are my own.
  double x[5][5] =
   {{0.60241373004273, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000},
    {0.43609630817057, 0.93143802262953, 0.00000000000000, 0.00000000000000, 0.00000000000000},
    {0.35999560258981, 0.84313177033664, 0.98601645224408, 0.00000000000000, 0.00000000000000},
    {0.31419680881426, 0.77373902177668, 0.95657266606026, 0.99649075402511, 0.00000000000000},
    {0.27848958159945, 0.71163434521951, 0.92067315806606, 0.98603002556249, 0.99890322247706}};

  // polar weights @todo normalize
  double w[5][5] =
   {{1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000},
    {0.78714600000000, 0.21285400000000, 0.00000000000000, 0.00000000000000, 0.00000000000000},
    {0.67014800000000, 0.28361900000000, 0.04623300000000, 0.00000000000000, 0.00000000000000},
    {0.59426914000000, 0.30817276000000, 0.08582263000000, 0.01173545000000, 0.00000000000000},
    {0.53269822000000, 0.31699288000000, 0.11831753000000, 0.02830905000000, 0.00368232000000}};

  int m = d_m / 2;
  for (int i = 0; i < m; ++i)
  {
    d_x[i  ] = -x[m-1][m-i-1];
    d_x[i+m] =  x[m-1][i    ];
    d_w[i  ] =  w[m-1][m-i-1];
    d_w[i+m] =  w[m-1][i    ];
  }

}

} // end namespace detran_angle

//----------------------------------------------------------------------------//
//              end of file TabuchiYamamoto.cc
//----------------------------------------------------------------------------//
